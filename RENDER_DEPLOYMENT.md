# GarageGuru - Render.com Production Deployment Guide

## Prerequisites
- GitHub repository with your GarageGuru code
- Render.com account
- Gmail account (for email features)

## Step 1: Database Setup
1. **Create PostgreSQL Database**:
   - Go to Render Dashboard → New → PostgreSQL
   - Name: `garageguru-db`
   - Database Name: `garageguru`  
   - User: `admin`
   - Plan: Starter ($7/month) or Free (limited)

2. **Note the connection details**:
   - Save the External Database URL for later

## Step 2: Web Service Deployment

### Option A: Using render.yaml (Recommended)
1. **Connect GitHub Repository**:
   - Go to Render Dashboard → New → Web Service
   - Connect your GitHub repository
   - Render will automatically detect `render.yaml`

**Build Configuration:**
- Build Command: `npm install && vite build`
- Start Command: `npm start`
- Uses tsx to run TypeScript directly in production

2. **Environment Variables** (Auto-configured from render.yaml):
   - `DATABASE_URL` - Auto-linked to your database
   - `JWT_SECRET` - Auto-generated secure key
   - Manual setup required:
     - `GMAIL_USER` - Your Gmail address
     - `GMAIL_APP_PASSWORD` - Gmail app-specific password
     - `SUPER_ADMIN_EMAIL` - Your admin email
     - `ADMIN_ACTIVATION_CODE` - Create secure code
     - `STAFF_ACTIVATION_CODE` - Create secure code

### Option B: Manual Configuration
1. **Basic Settings**:
   - Name: `garageguru-production`
   - Environment: `Node`
   - Build Command: `npm install && npm run build`
   - Start Command: `npm start`

2. **Environment Variables**:
   ```
   NODE_ENV=production
   PORT=10000
   DATABASE_URL=[Your PostgreSQL External Database URL]
   JWT_SECRET=[Generate a secure 32+ character string]
   GMAIL_USER=[your-email@gmail.com]
   GMAIL_APP_PASSWORD=[your-gmail-app-password]
   SUPER_ADMIN_EMAIL=[admin@yourdomain.com]
   ADMIN_ACTIVATION_CODE=[secure-random-string]
   STAFF_ACTIVATION_CODE=[secure-random-string]
   ```

## Step 3: Gmail SMTP Setup
1. **Enable 2-Factor Authentication** on your Gmail account
2. **Generate App Password**:
   - Google Account → Security → App passwords
   - Generate password for "GarageGuru App"
   - Use this 16-character password as `GMAIL_APP_PASSWORD`

## Step 4: Deploy and Verify

### Initial Deployment
1. **Deploy**: Render automatically builds and deploys
2. **Monitor Build Logs**: Check for any build errors
3. **Health Check**: Service will be available at your Render URL

### Post-Deployment Verification
1. **Database Migration**: 
   - Automatic on first startup
   - Creates all 9 tables with proper schema

2. **Super Admin Setup**:
   - Access `/super-admin` endpoint
   - Use your `ADMIN_ACTIVATION_CODE` to gain access
   - System creates default super admin user

3. **Test Features**:
   - User registration and login
   - Database operations
   - Email notifications (if configured)
   - PDF invoice generation

## Step 5: Security and Monitoring

### Security Best Practices
- ✅ All secrets stored as environment variables
- ✅ JWT secrets auto-generated by Render
- ✅ Database connection encrypted (SSL)
- ✅ HTTPS enforced automatically
- ✅ CORS properly configured for production

### Production Monitoring
- **Health Endpoint**: `https://your-app.onrender.com/health`
- **Database Status**: Included in health check
- **Logs**: Available in Render dashboard

## Costs and Scaling
- **Web Service**: $7/month (Starter plan)
- **PostgreSQL**: $7/month (Starter) or Free (limited)
- **Total**: ~$14/month for production setup

The application will be available at: `https://garageguru-production.onrender.com`